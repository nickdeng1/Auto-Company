---
name: dev-start
description: 快捷命令：启动新需求。自动评估任务复杂度，选择L1/L2/L3流程。
---

# 启动新需求 (/dev-start)

> 快捷命令，评估任务复杂度，选择适合的开发流程

---

## 使用方式

```
/dev-start [需求描述]
```

## 示例

```
/dev-start 修复日期字段时区问题
/dev-start 为表单引擎添加AI按钮字段
/dev-start 重构流程引擎任务调度核心
```

---

## 执行流程

```
用户需求描述
     ↓
┌─────────────────────────────────────┐
│ 1. 任务分级评估                      │
│    - 调用 /dev-grading               │
│    - 5维度打分                       │
│    - 确定 L1/L2/L3 级别              │
└─────────────────────────────────────┘
     ↓
┌─────────────────────────────────────┐
│ 2. 显示分级结果                      │
│    - 推荐级别和置信度                │
│    - 评分详情                        │
│    - 流程预览                        │
└─────────────────────────────────────┘
     ↓
┌─────────────────────────────────────┐
│ 3. 用户确认/覆盖                     │
│    - 接受推荐级别                    │
│    - 或调整为其他级别                │
└─────────────────────────────────────┘
     ↓
┌─────────────────────────────────────┐
│ 4. 初始化需求                        │
│    - 创建需求目录                    │
│    - 生成 .progress.json             │
│    - 加载流程模板                    │
└─────────────────────────────────────┘
     ↓
┌─────────────────────────────────────┐
│ 5. 进入第一阶段                      │
│    - L1: /dev-quick-analysis         │
│    - L2: /dev-requirement            │
│    - L3: /dev-requirement            │
└─────────────────────────────────────┘
```

---

## 分级输出示例

```
┌─────────────────────────────────────────────────────────────┐
│  📊 任务分级评估                                             │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  需求: 修复日期字段时区问题                                  │
│                                                              │
│  推荐级别: L1 (简单任务)                                     │
│  置信度: 90%                                                 │
│                                                              │
│  评分详情:                                                   │
│  ├── 范围:       1/3  (单模块: 表单引擎)                     │
│  ├── 文件数:     1/3  (预估2个文件)                          │
│  ├── 风险级别:   1/3  (Bug修复)                              │
│  ├── 模式匹配:   1/3  (复用现有模式)                         │
│  └── 外部依赖:   1/3  (无外部调用)                           │
│                                                              │
│  总分: 5/15 → L1                                             │
│                                                              │
│  推荐流程 (3阶段/1确认):                                     │
│  ├── 阶段1: 快速分析                                         │
│  ├── 阶段2: 快速实现                                         │
│  └── 阶段3: 快速收尾 ← 确认点                                │
│                                                              │
│  [接受L1] [调整为L2] [调整为L3]                              │
└─────────────────────────────────────────────────────────────┘
```

---

## 流程对照

| 级别 | 名称 | 适用场景 | 阶段 | 确认 | 首阶段Skill |
|------|------|----------|------|------|-------------|
| L1 | 简单任务 | Bug修复、配置调整 | 3 | 1 | `/dev-quick-analysis` |
| L2 | 中等任务 | 新字段、新组件 | 5 | 2 | `/dev-requirement` |
| L3 | 复杂任务 | 新模块、架构变更 | 8 | 8 | `/dev-requirement` |
| L3-AUTO | 自主模式 | 确定性高的复杂任务 | 8 | 0 | `/dev-requirement` + 自动流转 |

---

## 进度文件初始化

创建 `docs/需求记录/[需求名]/.progress.json`:

```json
{
  "requirementId": "REQ-2026-002",
  "requirementName": "[需求名]",
  "startTime": "2026-02-09T10:00:00",
  "taskGrade": {
    "level": "L1",
    "score": 5,
    "breakdown": {
      "scope": 1,
      "fileCount": 1,
      "riskLevel": 1,
      "patternMatch": 1,
      "externalDeps": 1
    },
    "userOverride": false
  },
  "flowTemplate": {
    "type": "L1_SIMPLE",
    "stages": ["quick-analysis", "quick-impl", "quick-finish"],
    "confirmationPoints": [3],
    "totalStages": 3
  },
  "metrics": {
    "totalDuration": null,
    "stageMetrics": [],
    "confirmationCount": 0,
    "rollbackCount": 0,
    "filesModified": 0
  },
  "currentStage": 1,
  "stages": [
    {
      "stage": 1,
      "name": "快速分析",
      "skill": "/dev-quick-analysis",
      "status": "pending",
      "startTime": null,
      "endTime": null,
      "artifacts": []
    },
    {
      "stage": 2,
      "name": "快速实现",
      "skill": "/dev-quick-impl",
      "status": "pending",
      "startTime": null,
      "endTime": null,
      "artifacts": []
    },
    {
      "stage": 3,
      "name": "快速收尾",
      "skill": "/dev-quick-finish",
      "status": "pending",
      "startTime": null,
      "endTime": null,
      "artifacts": []
    }
  ],
  "decisions": [],
  "notes": []
}
```

---

## 快速模式

支持跳过分级评估，直接指定级别：

```
/dev-start --l1 修复日期字段时区问题
/dev-start --l2 为表单引擎添加AI按钮字段
/dev-start --l3 重构流程引擎任务调度核心
```

---

## L3自主模式 (--l3-auto)

启用 L3 自主模式，全流程自动执行：

```
/dev-start --l3-auto 需求描述
```

### 自主模式特点

| 特性 | 普通L3 | L3-AUTO |
|------|--------|---------|
| 确认点 | 每阶段等待确认 | 无需确认，自动执行 |
| 质量门禁 | 手动检查 | 每阶段自动检查 |
| 暂停条件 | 需要用户输入 | 仅异常时暂停 |
| 恢复方式 | `/dev-next` | `/dev-resume` |

### 自主模式执行流程

```
/dev-start --l3-auto 需求描述
     ↓
┌─────────────────────────────────────┐
│ 1. 初始化自主流程                    │
│    - 创建需求目录                    │
│    - 生成 .progress.json             │
│    - 加载 L3_AUTO 流程模板           │
│    - 设置 autoFlow: true             │
└─────────────────────────────────────┘
     ↓
┌─────────────────────────────────────┐
│ 2. 启动自动执行循环                  │
│    - 调用 dev-auto-flow              │
│    - 自动执行每个阶段                │
│    - 每阶段自动质量门禁              │
└─────────────────────────────────────┘
     ↓
┌─────────────────────────────────────┐
│ 3. 完成或暂停                        │
│    - 全部通过 → 生成最终报告         │
│    - 门禁失败 → 暂停并通知           │
└─────────────────────────────────────┘
```

### 自主模式输出示例

```
┌─────────────────────────────────────────────────────────────┐
│  🤖 启动L3自主模式                                           │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  需求: 重构流程引擎任务调度核心                              │
│  级别: L3-AUTO (自主模式)                                    │
│  流程: 8阶段 / 自动质量门禁                                  │
│                                                              │
│  自主模式说明:                                               │
│  ├── ✅ 全流程自动执行                                       │
│  ├── ✅ 每阶段自动质量门禁                                   │
│  ├── ⏸ 仅异常时暂停                                         │
│  └── 🔄 支持断点恢复 (/dev-resume)                           │
│                                                              │
│  开始时间: 2026-02-09 10:00                                  │
│  预估完成: ~2小时                                            │
│                                                              │
│  正在执行阶段1: 需求分析...                                  │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

### 适用场景

L3-AUTO 适合以下场景：
- 确定性高的任务（成熟模式）
- 不需要频繁人工确认的任务
- 希望最大化自动化的任务

> ⚠️ 首次使用新模式时，建议使用普通 L3 流程，积累经验后再使用 L3-AUTO

---

## 等同于

```
/dev-orchestrator 开始新需求: [需求描述]
```
