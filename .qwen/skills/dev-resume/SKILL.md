---
name: dev-resume
description: 恢复暂停的L3自主模式。修复问题后从断点继续执行。
---

# 恢复自主模式 (/dev-resume)

> 恢复暂停的 L3-AUTO 自主模式，从断点继续执行

---

## 使用方式

```
/dev-resume
```

---

## 适用场景

当 L3-AUTO 模式因以下原因暂停时使用：

| 暂停原因 | 说明 | 恢复前需要 |
|----------|------|------------|
| `qualityGateFailed` | 质量门禁不通过 | 修复代码问题 |
| `aiReviewRed` | AI审查有红色项 | 修复安全/逻辑问题 |
| `compileFailed` | 编译失败 | 修复编译错误 |
| `testFailed` | 测试失败 | 修复测试问题 |
| `userInterrupt` | 用户手动中断 | 准备好后恢复 |

---

## 执行流程

```
/dev-resume
     ↓
┌─────────────────────────────────────┐
│ 1. 读取进度文件                      │
│    - 加载 .progress.json             │
│    - 检查 autoFlowState.status       │
│    - 确认是 L3_AUTO 流程             │
└─────────────────────────────────────┘
     ↓
┌─────────────────────────────────────┐
│ 2. 验证暂停状态                      │
│    - 确认当前是暂停状态              │
│    - 获取暂停原因                    │
│    - 获取暂停阶段                    │
└─────────────────────────────────────┘
     ↓
┌─────────────────────────────────────┐
│ 3. 重新执行检查                      │
│    - 重新运行质量门禁                │
│    - 或重新运行AI审查                │
│    - 验证问题是否修复                │
└─────────────────────────────────────┘
     ↓
┌─────────────────────────────────────┐
│ 4. 恢复执行                          │
│    - 检查通过 → 继续自动执行         │
│    - 检查失败 → 保持暂停，提示修复   │
└─────────────────────────────────────┘
```

---

## 恢复成功

```
┌─────────────────────────────────────────────────────────────┐
│  ▶ L3自主模式已恢复                                         │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  需求: 重构流程引擎任务调度                                  │
│  恢复阶段: 5/8 编码实现                                      │
│  暂停时长: 15分钟                                            │
│                                                              │
│  重新检查结果:                                               │
│  ├── 质量门禁: 82分 ✅ 通过 (之前55分)                       │
│  └── AI审查: 通过 ✅ (问题已修复)                            │
│                                                              │
│  继续执行阶段5: 编码实现...                                  │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

---

## 恢复失败

```
┌─────────────────────────────────────────────────────────────┐
│  ⚠ 无法恢复 - 问题未完全修复                                │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  需求: 重构流程引擎任务调度                                  │
│  暂停阶段: 5/8 编码实现                                      │
│                                                              │
│  重新检查结果:                                               │
│  ├── 质量门禁: 58分 ❌ 仍不通过 (需要≥60分)                  │
│  └── 问题: 测试覆盖率仍为 52% (需要≥70%)                    │
│                                                              │
│  请继续修复以下问题:                                        │
│  1. 增加更多测试用例                                        │
│                                                              │
│  修复后再次执行 /dev-resume                                 │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

---

## 无暂停状态

```
┌─────────────────────────────────────────────────────────────┐
│  ℹ 无需恢复                                                  │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  当前没有暂停的自主模式需求                                  │
│                                                              │
│  可能情况:                                                   │
│  - 自主模式正在执行中                                        │
│  - 自主模式已完成                                            │
│  - 当前不是 L3-AUTO 流程                                     │
│                                                              │
│  使用 /dev-status 查看当前状态                               │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

---

## 进度文件更新

恢复执行时更新 `.progress.json`:

```json
{
  "autoFlowState": {
    "status": "running",
    "pauseHistory": [
      {
        "stage": 5,
        "reason": "qualityGateFailed",
        "pausedAt": "2026-02-09T12:30:00",
        "resumedAt": "2026-02-09T12:45:00",
        "pauseDuration": 900000
      }
    ]
  }
}
```

---

## 与其他skill的协作

| Skill | 协作方式 |
|-------|----------|
| dev-auto-flow | 恢复后调用自动流转控制器 |
| dev-quality-gate | 重新执行质量门禁检查 |
| dev-ai-review | 重新执行AI审查 |
| dev-status | 显示暂停/恢复状态 |

---

## 最佳实践

1. **修复后验证**: 恢复前先手动运行测试/编译确认问题已修复
2. **查看详情**: 使用 `/dev-status` 查看具体暂停原因
3. **逐个修复**: 如有多个问题，可以逐个修复后尝试恢复
4. **降级处理**: 如问题难以解决，可考虑切换为手动 L3 模式
