---
name: dev-tech-spec
description: 技术方案技能。编写详细的技术设计文档，包括架构设计、接口定义、数据模型。开发流程第 3 阶段。
---

# 技术方案 (Technical Specification)

> 开发流程第 3 阶段：设计架构 → 定义接口 → 规划数据模型

---

## 前置条件

- 已完成需求分析（`/dev-requirement`）
- 已完成技术分析（`/dev-tech-analysis`）
- 技术分析文档已确认

---

## 执行流程

```
技术分析文档
     ↓
┌─────────────────────────────────────┐
│ 1. 架构设计                          │
│    - 组件划分                        │
│    - 层次结构                        │
│    - 依赖关系                        │
└─────────────────────────────────────┘
     ↓
┌─────────────────────────────────────┐
│ 2. 接口设计                          │
│    - API 定义                        │
│    - 参数规范                        │
│    - 返回格式                        │
└─────────────────────────────────────┘
     ↓
┌─────────────────────────────────────┐
│ 3. 数据模型设计                      │
│    - 实体定义                        │
│    - 字段说明                        │
│    - 关系映射                        │
└─────────────────────────────────────┘
     ↓
┌─────────────────────────────────────┐
│ 4. 核心流程设计                      │
│    - 时序图                          │
│    - 状态流转                        │
│    - 异常处理                        │
└─────────────────────────────────────┘
     ↓
┌─────────────────────────────────────┐
│ 5. 输出技术方案文档                   │
│    - 存储到 docs/ 目录                │
│    - 格式化为 Markdown                │
└─────────────────────────────────────┘
     ↓
人工确认 → 进入编码计划阶段
```

---

## 输出模板

```markdown
# 技术方案：[需求标题]

> 版本：1.0 | 日期：[日期] | 作者：AI辅助开发系统

---

## 1. 概述

### 1.1 背景
[需求背景和目标]

### 1.2 范围
- 包含：[功能点列表]
- 不包含：[明确排除的内容]

---

## 2. 架构设计

### 2.1 整体架构

```
[ASCII 架构图]
```

### 2.2 组件说明

| 组件 | 职责 | 位置 |
|------|------|------|
| [组件名] | [职责描述] | [代码路径] |

### 2.3 依赖关系

```
[组件A] → [组件B] → [组件C]
```

---

## 3. 接口设计

### 3.1 [接口名称]

**请求**
```
[METHOD] [URL]
Content-Type: application/json

{
  "field1": "string",
  "field2": 123
}
```

**响应**
```json
{
  "success": true,
  "data": {}
}
```

**错误码**

| 错误码 | 说明 |
|--------|------|
| [code] | [描述] |

---

## 4. 数据模型

### 4.1 [实体名称]

| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| [字段名] | [类型] | 是/否 | [说明] |

### 4.2 关系图

```
[实体A] 1--* [实体B]
```

---

## 5. 核心流程

### 5.1 [流程名称]

```
[参与者1]    [参与者2]    [参与者3]
    |            |            |
    |---请求---->|            |
    |            |---处理---->|
    |            |<---响应----|
    |<---响应----|            |
```

### 5.2 状态流转

```
[状态A] --[条件]--> [状态B] --[条件]--> [状态C]
```

---

## 6. 异常处理

| 异常场景 | 处理方式 |
|----------|----------|
| [场景] | [处理] |

---

## 7. 非功能需求

### 7.1 性能要求
- [要求1]

### 7.2 安全要求
- [要求1]

---

## 8. 下一步

进入编码计划阶段，使用 `/dev-coding-plan`
```

---

## 设计规范

### 遵循现有模式

1. **表单字段** - 继承 BaseFormField，使用 @Widget 注解
2. **流程节点** - 实现 Behavior 接口，注册到节点类型
3. **业务组件** - 继承 AbstractBusinessBehavior
4. **按钮行为** - 继承 AbstractBusinessButtonBehavior
5. **定时任务** - 实现 TriggerHandle
6. **事件** - 继承 BatchableEngineEvent

### 命名规范

| 类型 | 命名规则 | 示例 |
|------|----------|------|
| 实体类 | XxxEntity | AISkillEntity |
| 服务类 | XxxService | AISkillService |
| 控制器 | XxxController | AISkillController |
| DTO | XxxDTO / XxxRequest / XxxResponse | ChatRequest |
| 枚举 | XxxEnum / XxxType | AgentPlatformType |
